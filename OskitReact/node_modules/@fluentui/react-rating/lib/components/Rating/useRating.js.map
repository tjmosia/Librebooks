{"version":3,"sources":["useRating.tsx"],"sourcesContent":["import * as React from 'react';\nimport {\n  getIntrinsicElementProps,\n  isHTMLElement,\n  mergeCallbacks,\n  slot,\n  useControllableState,\n  useId,\n} from '@fluentui/react-utilities';\nimport type { RatingProps, RatingState } from './Rating.types';\nimport { RatingItem } from '../../RatingItem';\nimport { StarFilled, StarRegular } from '@fluentui/react-icons';\n\n/**\n * Create the state required to render Rating.\n *\n * The returned state can be modified with hooks such as useRatingStyles_unstable,\n * before being passed to renderRating_unstable.\n *\n * @param props - props from this instance of Rating\n * @param ref - reference to root HTMLElement of Rating\n */\nexport const useRating_unstable = (props: RatingProps, ref: React.Ref<HTMLDivElement>): RatingState => {\n  const generatedName = useId('rating-');\n  const {\n    color = 'neutral',\n    iconFilled = StarFilled,\n    iconOutline = StarRegular,\n    max = 5,\n    name = generatedName,\n    onChange,\n    step = 1,\n    size = 'extra-large',\n  } = props;\n\n  const [value, setValue] = useControllableState({\n    state: props.value,\n    defaultState: props.defaultValue,\n    initialState: 0,\n  });\n\n  const isRatingRadioItem = (target: EventTarget): target is HTMLInputElement =>\n    isHTMLElement(target, { constructorName: 'HTMLInputElement' }) && target.type === 'radio' && target.name === name;\n\n  const [hoveredValue, setHoveredValue] = React.useState<number | undefined>(undefined);\n\n  // Generate the child RatingItems and memoize them to prevent unnecessary re-rendering\n  const rootChildren = React.useMemo(() => {\n    return Array.from(Array(max), (_, i) => <RatingItem value={i + 1} key={i + 1} />);\n  }, [max]);\n\n  const state: RatingState = {\n    color,\n    iconFilled,\n    iconOutline,\n    name,\n    step,\n    size,\n    value,\n    hoveredValue,\n    components: {\n      root: 'div',\n    },\n    root: slot.always(\n      getIntrinsicElementProps(\n        'div',\n        {\n          ref,\n          children: rootChildren,\n          role: 'radiogroup',\n          ...props,\n        },\n        ['onChange'],\n      ),\n      { elementType: 'div' },\n    ),\n  };\n\n  state.root.onChange = ev => {\n    if (isRatingRadioItem(ev.target)) {\n      const newValue = parseFloat(ev.target.value);\n      if (!isNaN(newValue)) {\n        setValue(newValue);\n        onChange?.(ev, { type: 'change', event: ev, value: newValue });\n      }\n    }\n  };\n  state.root.onMouseOver = mergeCallbacks(props.onMouseOver, ev => {\n    if (isRatingRadioItem(ev.target)) {\n      const newValue = parseFloat(ev.target.value);\n      if (!isNaN(newValue)) {\n        setHoveredValue(newValue);\n      }\n    }\n  });\n  state.root.onMouseLeave = mergeCallbacks(props.onMouseLeave, ev => {\n    setHoveredValue(undefined);\n  });\n\n  return state;\n};\n"],"names":["React","getIntrinsicElementProps","isHTMLElement","mergeCallbacks","slot","useControllableState","useId","RatingItem","StarFilled","StarRegular","useRating_unstable","props","ref","generatedName","color","iconFilled","iconOutline","max","name","onChange","step","size","value","setValue","state","defaultState","defaultValue","initialState","isRatingRadioItem","target","constructorName","type","hoveredValue","setHoveredValue","useState","undefined","rootChildren","useMemo","Array","from","_","i","key","components","root","always","children","role","elementType","ev","newValue","parseFloat","isNaN","event","onMouseOver","onMouseLeave"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":"AAAA,YAAYA,WAAW,QAAQ;AAC/B,SACEC,wBAAwB,EACxBC,aAAa,EACbC,cAAc,EACdC,IAAI,EACJC,oBAAoB,EACpBC,KAAK,QACA,4BAA4B;AAEnC,SAASC,UAAU,QAAQ,mBAAmB;AAC9C,SAASC,UAAU,EAAEC,WAAW,QAAQ,wBAAwB;AAEhE;;;;;;;;CAQC,GACD,OAAO,MAAMC,qBAAqB,CAACC,OAAoBC;IACrD,MAAMC,gBAAgBP,MAAM;IAC5B,MAAM,EACJQ,QAAQ,SAAS,EACjBC,aAAaP,UAAU,EACvBQ,cAAcP,WAAW,EACzBQ,MAAM,CAAC,EACPC,OAAOL,aAAa,EACpBM,QAAQ,EACRC,OAAO,CAAC,EACRC,OAAO,aAAa,EACrB,GAAGV;IAEJ,MAAM,CAACW,OAAOC,SAAS,GAAGlB,qBAAqB;QAC7CmB,OAAOb,MAAMW,KAAK;QAClBG,cAAcd,MAAMe,YAAY;QAChCC,cAAc;IAChB;IAEA,MAAMC,oBAAoB,CAACC,SACzB3B,cAAc2B,QAAQ;YAAEC,iBAAiB;QAAmB,MAAMD,OAAOE,IAAI,KAAK,WAAWF,OAAOX,IAAI,KAAKA;IAE/G,MAAM,CAACc,cAAcC,gBAAgB,GAAGjC,MAAMkC,QAAQ,CAAqBC;IAE3E,sFAAsF;IACtF,MAAMC,eAAepC,MAAMqC,OAAO,CAAC;QACjC,OAAOC,MAAMC,IAAI,CAACD,MAAMrB,MAAM,CAACuB,GAAGC,kBAAM,oBAAClC;gBAAWe,OAAOmB,IAAI;gBAAGC,KAAKD,IAAI;;IAC7E,GAAG;QAACxB;KAAI;IAER,MAAMO,QAAqB;QACzBV;QACAC;QACAC;QACAE;QACAE;QACAC;QACAC;QACAU;QACAW,YAAY;YACVC,MAAM;QACR;QACAA,MAAMxC,KAAKyC,MAAM,CACf5C,yBACE,OACA;YACEW;YACAkC,UAAUV;YACVW,MAAM;YACN,GAAGpC,KAAK;QACV,GACA;YAAC;SAAW,GAEd;YAAEqC,aAAa;QAAM;IAEzB;IAEAxB,MAAMoB,IAAI,CAACzB,QAAQ,GAAG8B,CAAAA;QACpB,IAAIrB,kBAAkBqB,GAAGpB,MAAM,GAAG;YAChC,MAAMqB,WAAWC,WAAWF,GAAGpB,MAAM,CAACP,KAAK;YAC3C,IAAI,CAAC8B,MAAMF,WAAW;gBACpB3B,SAAS2B;gBACT/B,qBAAAA,+BAAAA,SAAW8B,IAAI;oBAAElB,MAAM;oBAAUsB,OAAOJ;oBAAI3B,OAAO4B;gBAAS;YAC9D;QACF;IACF;IACA1B,MAAMoB,IAAI,CAACU,WAAW,GAAGnD,eAAeQ,MAAM2C,WAAW,EAAEL,CAAAA;QACzD,IAAIrB,kBAAkBqB,GAAGpB,MAAM,GAAG;YAChC,MAAMqB,WAAWC,WAAWF,GAAGpB,MAAM,CAACP,KAAK;YAC3C,IAAI,CAAC8B,MAAMF,WAAW;gBACpBjB,gBAAgBiB;YAClB;QACF;IACF;IACA1B,MAAMoB,IAAI,CAACW,YAAY,GAAGpD,eAAeQ,MAAM4C,YAAY,EAAEN,CAAAA;QAC3DhB,gBAAgBE;IAClB;IAEA,OAAOX;AACT,EAAE"}